// 🔒 Firestore セキュリティルール（開発用）
// Firebase Console の Rules タブにコピー&ペーストしてください

rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    
    // 📋 requests コレクション（配達要請）
    match /requests/{requestId} {
      // 誰でも読み取り可能（配達員が要請を見るため）
      allow read: if true;
      
      // 誰でも作成・更新可能（被災者が要請、配達員が状況更新）
      allow create, update: if true;
      
      // 削除は禁止（データの保持のため）
      allow delete: if false;
    }
    
    // 📊 deliveries コレクション（配達履歴）
    match /deliveries/{deliveryId} {
      // 誰でも読み書き可能（統計情報のため）
      allow read, write: if true;
    }
    
    // 📱 その他のコレクション（将来追加用）
    match /{document=**} {
      // デフォルトは読み取りのみ
      allow read: if true;
      allow write: if false;
    }
  }
}

/*
👶 解説：
- allow read: if true = 「誰でも読める」
- allow write: if true = 「誰でも書ける」
- allow delete: if false = 「削除禁止」
- 災害時は緊急性を優先して、アクセス制限を緩くしています
- 本番環境では認証機能を追加してセキュリティを強化する必要があります
*/